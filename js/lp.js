function start(){injectJs(),$(function(){$(window).scrollTop(0),main()})}function injectJs(){for(var e in inject)$("head").append('<script src="'+inject[e]+'" type="text/javascript"></script>')}function init(){var e=$(window),t=new MsgDialog;if($("[data-btnclick-gagcategory]").click(function(){var e=$(this).attr("data-btnclick-gagcategory"),t=$(this).attr("data-btnclick-gaaction");onGAGoal(e,t)}),$("[data-btnclick-ymgoal]").click(function(){var e=$(this).attr("data-btnclick-ymgoal");onYMGoal(e)}),e.scroll(function(){var t=e.scrollTop();for(var o in parallax)if(parallax[o].on[currentDeviceType]){var a=parseInt(t*parallax[o].conf.speed/100),r=[];if(parallax[o].init&&parallax[o].init["background-position"])for(var n in parallax[o].init["background-position"]){var i=parallax[o].init["background-position"][n].split(" ");parallax[o].parallaxFromElTop&&(a=parseInt((t-parallax[o].e.offset().top)*parallax[o].conf.speed/100)),i[1]="calc("+i[1]+" + "+a+"px)",r.push(i.join(" "))}parallax[o].e.css("background-position",r.join(","))}checkScrollTriggers(e)}),jQuery.fn.dialog&&initDialogs(),$('[data-type="link-modal"]').click(function(e){return $($(this).attr("href")).closest(".modalWindowWrap").dialog("open"),e.preventDefault(),!1}),$('[data-type="link-section"]').click(function(e){var t=this;$("html, body").animate({scrollTop:$($(t).attr("href")).offset().top},500),$(t).trigger("onClick"),e.preventDefault()}),$('[data-type="formButton"]').click(function(e){return $($(this).attr("href")+" form").submit(),e.preventDefault(),!1}),$("form").submit(function(e){var o=$(this),a=o.attr("data-formAction"),r=o.attr("data-formsubmit-gagcategory"),n=o.attr("data-formsubmit-gaaction"),i=o.attr("data-formsubmit-ymgoal"),s=!1;return o.find('[data-fieldRequired="required"]').each(function(){""===$(this).val()?($(this).addClass("notValid"),s=!0):$(this).removeClass("notValid")}),s?(e.preventDefault(),o.find(".notValid").each(function(e,t){showTT(t,"Поле обязательно для заполнения")}),!1):(postFormData(o,function(){switch(r&&""!==r&&onGAGoal(r,n),i&&onYMGoal(i),a){case"msg":t.show(o.attr("data-msg"));break;case"url":var e=o.attr("data-url");redirect(e)}o[0].reset()}),e.preventDefault(),!1)}),currentDeviceType=getDeviceType(),additionalFields){var o={action:"set_type",type:currentDeviceType};o.type===DeviceTypes.phoneL&&(o.type=DeviceTypes.phone),o.additionalFields=additionalFields,$("form").each(function(){var e=$(this);for(var t in additionalFields)e.append('<input type="hidden" name="additionalFields['+t+']" value="'+additionalFields[t]+'" />')});$.post(window.postUrl,o).done(function(e){}).fail(function(e){toLog("error",e)}).always(function(e){})}e.off("resize",onWindowResized).on("resize",onWindowResized),initMousewheel(),initSyncStartAnimation(),disableFormSendOnEnter()}function initTriggers(e){for(var t in e)try{var o=e[t].ttargets.selectors.join(", ");createTrigger(o,e[t])}catch(a){console.log(a)}}function createTrigger(e,t){var o=$("body");switch(t.tid){case"click":o.on("click",e,createTriggerFunction(t));break;case"dblClick":o.on("dblclick",e,createTriggerFunction(t));break;case"mouseenter":o.on("mouseenter",e,createTriggerFunction(t));break;case"mouseleave":o.on("mouseleave",e,createTriggerFunction(t));break;case"pageloaded":$(createTriggerFunction(t));break;case"onScroll":softScrollTriggers.hasOwnProperty(e)||(softScrollTriggers[e]={e:$(e),actions:[]}),softScrollTriggers[e].actions.push({f:createTriggerFunction(t),from:t.tops[0],when:t.tops[1],to:t.tops[2],diff:parseInt(t.tops[3])||0});break;case"userEvent":o.on(t.tops[0],e,createTriggerFunction(t))}}function selectElements(e,t){var o=$(t);if(e&&"string"==typeof e)return"$"===e[0]?new Function("$this","return "+e.substr(1))(o):$(e)}function createTriggerFunction(e){return function(t){if(!t||"click"!==t.type||!t.isTrigger)if(e.st){var o=this;setTimeout(function(){runTriggerFunction(e,o,t)},e.st)}else runTriggerFunction(e,this,t)}}function runTriggerFunction(e,t){try{if(e.runOnce){if(e.hasBeenRunned)return;e.hasBeenRunned=!0}var o=e.ftargets.selectors.join(", ");switch(e.fid){case"s_showEl":selectElements(o,t).css({display:"block"});break;case"s_hideEl":selectElements(o,t).css({display:"none"});break;case"s_toggleEl":selectElements(o,t).toggle();break;case"s_addClass":selectElements(o,t).addClass(e.fops[0]);break;case"s_rmClass":selectElements(o,t).removeClass(e.fops[0]);break;case"s_sendEvent":selectElements(o,t).trigger(e.fops[0]);break;case"s_toggleClass":selectElements(o,t).toggleClass(e.fops[0]);break;case"s_switchClass":selectElements(o,t).switchClass(e.fops[0]);break;case"s_setText":selectElements(o+".block_text .block_content",t).text(e.fops[0]);break;case"s_selectTab":var a=$(t).index();selectElements(o,t).trigger("swToN",a);break;case"s_selectTabN":selectElements(o,t).trigger("swToN",parseInt(e.fops[0])-1);break;case"s_selectNext":selectElements(o,t).trigger("swToNext");break;case"s_selectPrev":selectElements(o,t).trigger("swToPrev");break;case"s_click":selectElements(o,t).each(function(e,t){t.click()});break;case"s_dblClick":selectElements(o,t).dblclick();break;case"s_openDD":case"s_closeDD":case"s_toggleDD":selectElements(o,t).trigger(e.fid);break;case"s_openUrl":window.location.href=e.fops[0];break;case"s_openUrlInTab":window.open(e.fops[0])}}catch(r){console.log(r)}}function onGAGoal(e,t){try{var o=_gaq._getAsyncTracker();o._trackEvent(e,t)}catch(a){}}function onYMGoal(e){try{if(window.hasOwnProperty("Ya")&&window.Ya.hasOwnProperty("Metrika")){var t=window.Ya.Metrika.counters()[0].id,o=window["yaCounter"+t];o&&o.reachGoal(e,function(){})}}catch(a){}}function initSyncStartAnimation(){$(".syncStartAnimation").on("scrollTrigger","div",function(e){e.stopPropagation();var t=$(this).closest(".lp_section");for(var o in scrollTriggers)scrollTriggers[o].closest(t).length>0&&(scrollTriggers[o].addClass("scrollTrigger"),delete scrollTriggers[o])})}function onWindowResized(){currentDeviceType=getDeviceType()}function disableFormSendOnEnter(){$("form input[type=text]").on("keydown",function(e){return 13===e.keyCode?(e.preventDefault(),!1):void 0})}function main(){parallax=[];for(var e in conf)switch(e){case"parallax":setParallax(conf[e]);break;case"scrollTriggers":for(var t in conf[e]){var o=conf[e][t];"#"!==o[0]&&"."!==o[0]&&(o="#"+o);var a=$(o);a.length>0?scrollTriggers[t]=a:toLog("error","can't find: "+o)}break;case"timer":initTimers(conf[e]);break;case"map":initMaps(conf[e]);break;case"triggers":initTriggers(conf[e])}checkScrollTriggers($(window)),jQuery.fn.rubberSlider&&$(".block_gallery .block_content, .block_gallery1 .block_content").rubberSlider(),jQuery.fn.LPSlider&&$(".lp_slider").LPSlider(),jQuery.fn.LPTabs&&$(".lp_tabs").LPTabs(),jQuery.fn.s_csw&&$(".tabs2_body_s").s_csw(),jQuery.fn.Navmenu&&$(".navbarmenu").Navmenu(),jQuery.fn.LPDropdown&&$(".dropdown").LPDropdown(),$(window).trigger("scroll")}function postFormData(e,t){var o=e.serialize();$.ajax({type:"POST",url:window.postUrl,dataType:"json",data:o,beforeSend:function(e){},success:function(e){},error:function(e,t,o){toLog("error",e,t,o)},complete:function(e){t&&t(e)}})}function getDeviceType(){var e=window.devicePixelRatio||1,t=$(window).width()/e;return 480>t?DeviceTypes.phone:768>t?DeviceTypes.phoneL:960>t?DeviceTypes.tablet:DeviceTypes.desktop}function redirect(e){e&&(window.location.href=e)}function initDialogs(){$(".is_modalWindow").each(function(){var e=$('<div class="modalWindowWrap">');e.append(this),e.dialog({modal:!0,autoOpen:!1,resizable:!1,width:"auto",height:"auto"})})}function MsgDialog(){var e=this;jQuery.fn.dialog&&(e.dialog=$('<div class="dialogContent">').dialog({autoOpen:!1,dialogClass:"alert",height:300,width:350,modal:!0,buttons:{"Закрыть":function(){e.dialog.dialog("close")}}})),this.show=function(t){e.dialog?(e.dialog.text(t),e.dialog.dialog("open")):alert(t)}}function checkScrollTriggers(e){var t=e.height(),o=e.scrollTop(),a=220;for(var r in scrollTriggers)scrollTriggers[r].each(function(){var e=$(this);o+t-a>=e.offset().top&&(delete scrollTriggers[r],e.addClass("scrollTrigger"),e.trigger("scrollTrigger",["Custom","Event"]))});for(var r in softScrollTriggers)softScrollTriggers[r].e.each(function(){var e=$(this),a=e.offset().top,n=e.height();for(var i in softScrollTriggers[r].actions){var s=softScrollTriggers[r].actions[i],l=!1;"top"===s.from&&"top"===s.to?l="above"===s.when?o-s.diff>=a:o+s.diff<a:"top"===s.from&&"bottom"===s.to?l="above"===s.when?o+t-s.diff>=a:o+t+s.diff<a:"bottom"===s.from&&"top"===s.to?l="above"===s.when?o-n-s.diff>=a:o-n+s.diff<a:"bottom"===s.from&&"bottom"===s.to&&(l="above"===s.when?o+t-n-s.diff>=a:o+t-n+s.diff<a),l?s.off||(s.f(),s.off=!0):softScrollTriggers[r].actions[i].off=!1}})}function setParallax(e){for(var t in e){var o={conf:e[t]};o.e=$(e[t].selector),o.on={},o.on[DeviceTypes.desktop]=o.e.hasClass("parallaxOnDesktop"),o.on[DeviceTypes.tablet]=o.e.hasClass("parallaxOnTablet"),o.on[DeviceTypes.phoneL]=o.e.hasClass("parallaxOnPhoneL"),o.on[DeviceTypes.phone]=o.e.hasClass("parallaxOnPhone"),o.parallaxFromElTop=o.e.hasClass("parallaxFromElTop");var a=o.e.css("background-position")||"";o.init={"background-position":a.split(", ")},parallax.push(o)}}function initTimers(e){for(var t in e){var o=e[t],a={conf:o};a.e=$(o.selector),timers.push(a);var r;"toDate"===o.timerTo?r=new Date(o.toDate):(r=new Date,r.setDate(r.getDate()+(o.dateD||0)),r.setHours(r.getHours()+(o.dateH||0)),r.setMinutes(r.getMinutes()+(o.dateM||0)),r.setSeconds(r.getSeconds()+(o.dateS||0)),a.e.rubberTimer({date:r})),a.e.rubberTimer({date:r})}}function initMaps(e){for(var t in e){var o=e[t],a={conf:o};a.e=$(o.selector),maps.push(a);"yandex"===o.mapService?!function(e,t){ymaps.ready(function(){a.map=new ymaps.Map(e,{center:t.center||[55.76,37.64],zoom:t.zoom||8,behaviors:["default","scrollZoom"]}),a.map.controls.add("zoomControl",{left:"5px",top:"5px"}),a.placemark=new ymaps.Placemark(t.center||[55.76,37.64]),a.map.geoObjects.add(a.placemark)})}(t,o):!function(e,t){google.maps.event.addDomListener(window,"load",function(){t.center?a.center=new google.maps.LatLng(t.center[0],t.center[1]):a.center=new google.maps.LatLng(55.755826,37.6173);var o={scrollwheel:!1,center:a.center,zoom:t.zoom||8,panControl:!1,zoomControl:!0,mapTypeControl:!0,scaleControl:!1,streetViewControl:!1,overviewMapControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP};a.map=new google.maps.Map(document.getElementById(e),o),a.marker=new google.maps.Marker({position:a.center,map:a.map})})}(t,o)}}function showTT(e,t,o,a){var r=$(e);if(!r.data("hasErrTT")){o||(o=r.offset(),o.top+=r.height());var n=$('<div class="editorDefaultTT"><span class="ttContent"></span></div>');n.text(t||"");var i=function(e){return function(){r.data("hasErrTT",!1),e.remove()}}(n);n.click(i),setTimeout(i,a||5e3),n.appendTo("body"),n.offset(o),n.show(),r.data("hasErrTT",!0)}}function toLog(){window.hasOwnProperty("console")&&window.console.log(arguments)}function initMousewheel(){if(jQuery.fn.hasOwnProperty("mousewheel")){$(".block_map").bind("mousewheel",function(e){e.preventDefault(),e.stopPropagation()});var e,t=$("html,body"),o=$("html"),a=$("body");$(document).bind("mousewheel",function(r){var n=$(document).height()-$(window).height();e||(e=o.scrollTop()+a.scrollTop()),0>e&&(e=0),e>n&&(e=n);var i=e-r.deltaY*r.deltaFactor*1;r.preventDefault(),r.stopPropagation(),e=i,t.stop().animate({scrollTop:i},100,"linear",function(){e=null})})}}var parallax=[],timers=[],maps=[],scrollTriggers={},softScrollTriggers={},currentDeviceType,DeviceTypes={phone:"phone",phoneL:"phoneL",tablet:"tablet",desktop:"desktop"};$(function(){window.hasOwnProperty("postUrl")||(window.postUrl="ajax.php"),window.hasOwnProperty("conf")||(window.conf={}),init(),main()});var EF={hideEl:function(e){$(e).hide()},showEl:function(e){$(e).show()},addClass:function(e,t){$(e).addClass(t)},rmClass:function(e,t){$(e).removeClass(t)}};